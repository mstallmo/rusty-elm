// Generated by BUCKLESCRIPT VERSION 5.0.3, PLEASE EDIT WITH CARE

import * as $$Array from "../node_modules/bs-platform/lib/es6/array.js";
import * as Curry from "../node_modules/bs-platform/lib/es6/curry.js";
import * as Caml_array from "../node_modules/bs-platform/lib/es6/caml_array.js";
import * as Elm$ReasonableRustyElm from "./Elm.bs.js";
import * as Psd$ReasonableRustyElm from "./Psd.bs.js";
import * as Render$ReasonableRustyElm from "./Render.bs.js";

function fillArrayBufferFromString(decodedString, arrayBuffer) {
  return arrayBuffer.map((function (param, index) {
                return decodedString.charCodeAt(index) | 0;
              }));
}

function fillClampedArrayFromArray(inputArray, arrayBuffer) {
  return arrayBuffer.map((function (param, index) {
                return Caml_array.caml_array_get(inputArray, index);
              }));
}

Elm$ReasonableRustyElm.newApp.ports.openPSDDocument.subscribe((function (imageUrl) {
        var decodedString = atob(Caml_array.caml_array_get(imageUrl.split(","), 1));
        var $$document = Psd$ReasonableRustyElm.parsePsd(fillArrayBufferFromString(decodedString, new Uint8Array(decodedString.length)));
        Elm$ReasonableRustyElm.newApp.ports.documentUpdated.send($$document);
        return /* () */0;
      }));

Elm$ReasonableRustyElm.newApp.ports.renderLayers.subscribe((function (layers) {
        console.log(layers);
        $$Array.map((function (layer) {
                var clampedArrayBuffer = fillClampedArrayFromArray(layer.image, new Uint8ClampedArray(layer.image.length));
                return Curry._2(Render$ReasonableRustyElm.renderPsd, layer.name, new ImageData(clampedArrayBuffer, 500, 500));
              }), layers);
        return /* () */0;
      }));

export {
  fillArrayBufferFromString ,
  fillClampedArrayFromArray ,
  
}
/*  Not a pure module */
